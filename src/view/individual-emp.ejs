
<%- include ('partials-home/_header-home')  %>

    <section class="slideshow">
        <div class="slide-body">
            <input type="radio" id="i1" name="images" checked />
            <input type="radio" id="i2" name="images" />
            
            <div class="slide_img" id="one"> <img src="/img/<%= data[0].img || 'default.png'%>"> </div>
            <div class="slide_img" id="two"> <img src="/img/home2.jpg"> </div>

            <div id="nav-slide">
                <label for="i1" class="dots" id="dot1"></label>
                <label for="i2" class="dots" id="dot2"></label>
            </div>
        </div>
    </section>

    <section class="dos">
        <h1 class="centrado texto-ng grande"><%= data[0].titulo%></h1>
        <div class="divisor">
            <div class="divisor-linea"></div>
        </div>
        <h3 class="texto-ng mediano centrado"> <%= data[0].descripcion%></h3>
        <div class="divisor"></div>
        <div class="row">
            <div class="col-servicio" style="margin-top: 60px;">
                <h3 class="texto-ng"><i class="fas fa-map-marker-alt texto-ng"></i> <%= data[0].geo_local%></h3>
                <h3 class="texto-ng"><i class="fas fa-phone texto-ng"></i> <%= data[0].telefono%></h3>
                <h3 class="texto-ng"><i class="fab fa-facebook-f texto-ng"></i> <%= data[0].facebook%></h3>
                <h3 class="texto-ng"><i class="fab fa-twitter texto-ng"></i> <%= data[0].twitter%></h3>
                <h3 class="texto-ng"><i class="fab fa-instagram texto-ng"></i> <%= data[0].instagram%></h3>
                <h3 class="texto-ng"><i class="fas fa-globe texto-ng"></i> <%= data[0].web%></h3>
            </div>
            <div class="col-servicio">
                <div id="map"></div>
            </div>
        </div>
    </section>

    <script>
        var a = '<%- JSON.stringify(data)%>';
        var data = JSON.parse(a);
        var delay = 100;
        var infowindow = new google.maps.InfoWindow();
        var geo = new google.maps.Geocoder(); 

        const map = new google.maps.Map(document.getElementById("map"), {
            zoom: 11,
            center: { lat: -33.59829709005887, lng: -71.60798902585982 },
        });
        var bounds = new google.maps.LatLngBounds();

        function getAddress(search, next, i) {
            geo.geocode({address:search}, function (results,status){ 
                if (status == google.maps.GeocoderStatus.OK) {

                    var marker = new google.maps.Marker({
                        position: results[0].geometry.location,
                        map: map,
                        title: data[i].titulo,
                        animation: google.maps.Animation.DROP
                    });
                    google.maps.event.addListener(marker, 'click', function() {
                        infowindow.setContent(data[i].titulo);
                        infowindow.open(map,marker);
                    });
                    bounds.extend(marker.position);
                }
                else {
                    if (status == google.maps.GeocoderStatus.OVER_QUERY_LIMIT) {
                        sigLugar--;
                        delay++;
                    } else {
                        alert("Geocode was not successful for the following reason: " + status);
                    }   
                }
                next();
            });
        }

        var lugares = []
        for (let i = 0; i < data.length; i++) { lugares.push(data[i].geo_local); }
        var sigLugar = 0;
        function inicio() {
            if (sigLugar < lugares.length) {
                setTimeout('getAddress("'+lugares[sigLugar]+'",inicio, sigLugar-1)', delay);
                sigLugar++;
            } else {
                map.fitBounds(bounds);
            }
        }
        inicio();
    </script>

<%- include ('partials-home/_footer-home')  %>